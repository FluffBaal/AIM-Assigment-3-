var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,i=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&n(e,r,t[r]);if(s)for(var r of s(t))o.call(t,r)&&n(e,r,t[r]);return e},l=(e,t,r)=>new Promise((s,a)=>{var o=e=>{try{i(r.next(e))}catch(t){a(t)}},n=e=>{try{i(r.throw(e))}catch(t){a(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(o,n);i((r=r.apply(e,t)).next())});import{b as d}from"./react-vendor-79u6xiU-.js";import{A as u}from"./index-CvtPTGeu.js";import{a as h}from"./axios-vendor-wEVgSxmm.js";const c=()=>{const e=d.useContext(u);if(void 0===e)throw new Error("useApiKey must be used within an ApiKeyProvider");return e};const p=new class{constructor(){var e,t;n(this,"symbol"!=typeof(e="axios")?e+"":e,t),this.axios=h.create({baseURL:"/api/v1",headers:{"Content-Type":"application/json"}}),this.axios.interceptors.response.use(e=>e,e=>{var t,r;if(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)throw new Error(e.response.data.error.message);throw e})}getAuthHeaders(e){return{"X-API-Key":e}}checkHealth(){return l(this,null,function*(){return(yield this.axios.get("/health/status")).data})}checkReadiness(){return l(this,null,function*(){return(yield this.axios.get("/health/ready")).data})}uploadPDF(e,s){return l(this,null,function*(){const a=new FormData;a.append("file",e);var o,n;return(yield this.axios.post("/upload/pdf",a,{headers:(o=i({},this.getAuthHeaders(s)),n={"Content-Type":"multipart/form-data"},t(o,r(n)))})).data})}getFileStatus(e,t){return l(this,null,function*(){return(yield this.axios.get(`/upload/pdf/${e}/status`,{headers:this.getAuthHeaders(t)})).data})}sendMessage(e,t){return l(this,null,function*(){return(yield this.axios.post("/chat/message",e,{headers:this.getAuthHeaders(t)})).data})}streamChat(e,t,r,s,a){const o=new AbortController;return fetch("/api/v1/chat/stream",{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":t},body:JSON.stringify(e),signal:o.signal}).then(e=>{var t;if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=null==(t=e.body)?void 0:t.getReader(),i=new TextDecoder;if(!n)throw new Error("No response body");l(null,null,function*(){try{let t="";for(;;){const{done:s,value:o}=yield n.read();if(s){a();break}t+=i.decode(o,{stream:!0});const l=t.split("\n");t=l.pop()||"";for(const t of l)if(t.startsWith("data: ")){const s=t.slice(6).trim();if("[DONE]"===s)return void a();if(s)try{const e=JSON.parse(s);r(e)}catch(e){}}}}catch(t){o.signal.aborted||s(t)}})}).catch(e=>{o.signal.aborted||s(e)}),()=>{o.abort()}}clearChatHistory(e,t){return l(this,null,function*(){yield this.axios.delete(`/chat/history/${e}`,{headers:this.getAuthHeaders(t)})})}};export{p as a,c as u};
